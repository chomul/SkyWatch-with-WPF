<UserControl x:Class="SkyWatch.Views.SearchView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="600" d:DesignWidth="800">

    <Grid Margin="28">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>  <!-- ê²€ìƒ‰ ìž…ë ¥ -->
            <RowDefinition Height="Auto"/>  <!-- ê²€ìƒ‰ ê²°ê³¼ í—¤ë” -->
            <RowDefinition Height="*"/>     <!-- ê²€ìƒ‰ ê²°ê³¼ ë¦¬ìŠ¤íŠ¸ -->
            <RowDefinition Height="Auto"/>  <!-- ìµœê·¼ ê²€ìƒ‰ -->
        </Grid.RowDefinitions>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- ê²€ìƒ‰ ìž…ë ¥ ë°•ìŠ¤                           -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <Border Grid.Row="0"
                Background="{DynamicResource GlassBrush}"
                BorderBrush="#664FA3FF" BorderThickness="1"
                CornerRadius="12" Padding="12,10"
                Margin="0,0,0,18">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <!-- ðŸ” ì•„ì´ì½˜ -->
                <TextBlock Grid.Column="0" Text="ðŸ”" FontSize="16"
                           Foreground="{DynamicResource TextMutedBrush}"
                           VerticalAlignment="Center" Margin="4,0,10,0"/>
                <!-- í…ìŠ¤íŠ¸ ìž…ë ¥ -->
                <TextBox Grid.Column="1"
                         Text="{Binding SearchQuery, UpdateSourceTrigger=PropertyChanged}"
                         Background="Transparent" BorderThickness="0"
                         Foreground="{DynamicResource TextPrimaryBrush}"
                         FontSize="14" FontWeight="Medium"
                         VerticalAlignment="Center"
                         CaretBrush="{DynamicResource AccentBlueBrush}"/>
                <!-- Placeholder í…ìŠ¤íŠ¸ (ì¿¼ë¦¬ ë¹„ì–´ìžˆì„ ë•Œ) -->
                <TextBlock Grid.Column="1"
                           Text="ë„ì‹œë¥¼ ê²€ìƒ‰í•˜ì„¸ìš”..."
                           FontSize="14"
                           Foreground="{DynamicResource TextMutedBrush}"
                           VerticalAlignment="Center"
                           IsHitTestVisible="False">
                    <TextBlock.Style>
                        <Style TargetType="TextBlock">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding SearchQuery.Length}" Value="0">
                                    <Setter Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>
                <!-- âœ• í´ë¦¬ì–´ ë²„íŠ¼ -->
                <Button Grid.Column="2"
                        Content="âœ•"
                        Command="{Binding ClearQueryCommand}"
                        Style="{x:Null}"
                        Background="Transparent" BorderThickness="0"
                        FontSize="13"
                        Foreground="{DynamicResource TextMutedBrush}"
                        Cursor="Hand" Padding="4,0"
                        VerticalAlignment="Center">
                    <Button.Visibility>
                        <Binding Path="SearchQuery.Length">
                            <Binding.Converter>
                                <BooleanToVisibilityConverter/>
                            </Binding.Converter>
                        </Binding>
                    </Button.Visibility>
                </Button>
            </Grid>
        </Border>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- ê²€ìƒ‰ ê²°ê³¼ í—¤ë”                           -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <TextBlock Grid.Row="1"
                   Text="ê²€ìƒ‰ ê²°ê³¼" FontSize="11"
                   Foreground="{DynamicResource TextMutedBrush}"
                   Margin="0,0,0,10">
            <TextBlock.Style>
                <Style TargetType="TextBlock">
                    <Setter Property="Visibility" Value="Collapsed"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding SearchQuery.Length, FallbackValue=0, Converter={x:Null}}" Value="0">
                            <!-- keep collapsed when empty -->
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </TextBlock.Style>
        </TextBlock>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- ê²€ìƒ‰ ê²°ê³¼ ë¦¬ìŠ¤íŠ¸                         -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <ItemsControl Grid.Row="2"
                      ItemsSource="{Binding SearchResults}">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Border x:Name="resultBorder"
                            Background="#08FFFFFF"
                            CornerRadius="10" Padding="12,10"
                            Margin="0,0,0,8" Cursor="Hand">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="36"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <!-- êµ­ê¸° -->
                            <TextBlock Grid.Column="0" Text="{Binding FlagEmoji}"
                                       FontSize="20" VerticalAlignment="Center"/>
                            <!-- ë„ì‹œ ì •ë³´ -->
                            <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="6,0,0,0">
                                <TextBlock Text="{Binding CityName}" FontSize="13" FontWeight="SemiBold"
                                           Foreground="{DynamicResource TextPrimaryBrush}"/>
                                <TextBlock Text="{Binding CountryName}" FontSize="11"
                                           Foreground="{DynamicResource TextMutedBrush}"
                                           Margin="0,2,0,0"/>
                            </StackPanel>
                            <!-- ì˜¨ë„ -->
                            <TextBlock x:Name="tempText" Grid.Column="2"
                                       Text="{Binding Temperature, StringFormat='{}{0:0}Â°'}"
                                       FontSize="16" FontWeight="SemiBold"
                                       Foreground="{DynamicResource AccentBlueBrush}"
                                       VerticalAlignment="Center" Margin="8,0,4,0"/>
                        </Grid>
                    </Border>
                    <DataTemplate.Triggers>
                        <DataTrigger Binding="{Binding IsTopResult}" Value="True">
                            <Setter TargetName="resultBorder" Property="Background" Value="#1A4FA3FF"/>
                            <Setter TargetName="resultBorder" Property="BorderBrush" Value="#334FA3FF"/>
                            <Setter TargetName="resultBorder" Property="BorderThickness" Value="1"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding IsTopResult}" Value="False">
                            <Setter TargetName="tempText" Property="Foreground" Value="{DynamicResource TextSecondaryBrush}"/>
                        </DataTrigger>
                    </DataTemplate.Triggers>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- ìµœê·¼ ê²€ìƒ‰                               -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <StackPanel Grid.Row="3" Margin="0,16,0,0">
            <TextBlock Text="ðŸ“Œ ìµœê·¼ ê²€ìƒ‰" FontSize="11"
                       Foreground="{DynamicResource TextMutedBrush}"
                       Margin="0,0,0,8"/>
            <ItemsControl ItemsSource="{Binding RecentSearches}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel Orientation="Horizontal"/>
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Background="#0DFFFFFF"
                                BorderBrush="#14FFFFFF" BorderThickness="1"
                                CornerRadius="20" Padding="12,4"
                                Margin="0,0,8,6" Cursor="Hand">
                            <Border.InputBindings>
                                <MouseBinding Gesture="LeftClick"
                                              Command="{Binding DataContext.SelectRecentSearchCommand,
                                                        RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                              CommandParameter="{Binding}"/>
                            </Border.InputBindings>
                            <TextBlock Text="{Binding}" FontSize="12"
                                       Foreground="{DynamicResource TextSecondaryBrush}"/>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </StackPanel>

        <!-- ê²€ìƒ‰ì–´ ì—†ì„ ë•Œ ë¹ˆ ìƒíƒœ ì•ˆë‚´ -->
        <StackPanel Grid.Row="2"
                    VerticalAlignment="Center" HorizontalAlignment="Center">
            <StackPanel.Style>
                <Style TargetType="StackPanel">
                    <Setter Property="Visibility" Value="Collapsed"/>
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding SearchResults.Count}" Value="0">
                            <Setter Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </StackPanel.Style>
            <TextBlock Text="ðŸ”" FontSize="40" HorizontalAlignment="Center" Margin="0,0,0,8"/>
            <TextBlock Text="ë„ì‹œ ì´ë¦„ì„ ìž…ë ¥í•˜ë©´ ê²€ìƒ‰ ê²°ê³¼ê°€ í‘œì‹œë©ë‹ˆë‹¤"
                       FontSize="13"
                       Foreground="{DynamicResource TextMutedBrush}"
                       HorizontalAlignment="Center"/>
        </StackPanel>
    </Grid>
</UserControl>
